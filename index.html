<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>For My Sundari ğŸ’›</title>

  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #ffdde1, #ee9ca7);
      color: #4a2c2a;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Floating Flowers */
    .flower-bg {
      position: fixed;
      top: -10%;
      z-index: 0;
      user-select: none;
      pointer-events: none;
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(110vh) rotate(360deg); opacity: 0; }
    }

    .container {
      background: rgba(255, 255, 255, 0.9);
      padding: 25px;
      border-radius: 30px;
      width: 90%;
      max-width: 450px;
      text-align: center;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      position: relative;
      margin: 20px;
      z-index: 1;
      border: 2px solid #fff;
    }

    .corner-flower { position: absolute; font-size: 1.5rem; z-index: 2; }
    .top-left { top: 10px; left: 10px; }
    .top-right { top: 10px; right: 10px; }
    .bottom-left { bottom: 10px; left: 10px; }
    .bottom-right { bottom: 10px; right: 10px; }

    /* SMOOTH IMAGE TRANSITION FIX */
    .photo-display {
      width: 250px;
      height: 250px;
      object-fit: cover;
      border-radius: 15px;
      margin: 0 auto 15px auto;
      display: block;
      box-shadow: 0 10px 20px rgba(238, 156, 167, 0.4);
      /* Changed to linear for consistent fading speed */
      transition: opacity 0.5s linear; 
      border: 4px solid white;
      opacity: 1;
    }

    #message {
      font-size: 1rem;
      line-height: 1.6;
      white-space: pre-wrap;
      height: 250px;
      overflow-y: auto;
      margin-bottom: 20px;
      text-align: left;
      padding: 15px;
      scroll-behavior: smooth;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 15px;
      border-left: 4px solid #ff5e7e;
    }

    .hidden { display: none; }
    .valentine-section h2 { margin-bottom: 20px; color: #ff5e7e; }

    button {
      padding: 12px 24px;
      font-size: 1rem;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      margin: 10px;
      transition: all 0.2s ease;
      font-weight: bold;
    }

    #yesBtn { background: #ff5e7e; color: white; box-shadow: 0 4px 15px rgba(255, 94, 126, 0.3); }
    #noBtn { background: #ccc; position: absolute; display: inline-block; z-index: 999; left: 50%; transform: translateX(10px); }

    .final-message {
      font-size: 1.4rem;
      color: #ff5e7e;
      font-weight: bold;
      animation: heartBeat 1.5s infinite;
    }
    
    @keyframes heartBeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
  </style>
</head>
<body> 
  <audio id="loveSong" src="Audio/Valentine_Audio.mpeg" preload="auto"></audio>
  <div id="flower-container"></div>

  <div class="container">
    <div class="corner-flower top-left">ğŸŒ¸</div>
    <div class="corner-flower top-right">âœ¨</div>
    <div class="corner-flower bottom-left">ğŸŒ¼</div>
    <div class="corner-flower bottom-right">ğŸŒ¸</div>

    <img id="slideshow" src="photos/photo1.jpg" class="photo-display" alt="Memories">
    
    <div id="message"></div>

    <div id="valentine" class="valentine-section hidden">
      <h2>Will you be my Valentine? ğŸ’–</h2>
      <button id="yesBtn">Yes ğŸ’›</button>
      <button id="noBtn">No ğŸ™ƒ</button>
    </div>

    <div id="final" class="hidden final-message">
      Yayyyy ğŸ¥°ğŸ’› <br>
      I knew itttt! <br><br>
      Happy Valentineâ€™s Day, Bangaram ğŸ’•
    </div>
  </div>

  <script>
    // 1. Floating flowers logic (same as before)
    const flowerContainer = document.getElementById('flower-container');
    const flowerEmojis = ['ğŸŒ¸', 'ğŸŒ¼', 'ğŸŒ·', 'âœ¨', 'ğŸ’›'];
    for (let i = 0; i < 20; i++) {
      let flower = document.createElement('div');
      flower.className = 'flower-bg';
      flower.innerHTML = flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)];
      flower.style.left = Math.random() * 100 + 'vw';
      flower.style.animationDuration = (Math.random() * 3 + 4) + 's';
      flower.style.fontSize = (Math.random() * 10 + 15) + 'px';
      flower.style.opacity = Math.random();
      flowerContainer.appendChild(flower);
    }

    const images = [
      "photos/photo1.jpg", "photos/photo2.jpeg", "photos/photo3.jpg",
      "photos/photo4.jpeg", "photos/photo5.jpeg", "photos/photo6.jpeg",
      "photos/photo7.jpeg", "photos/photo8.jpeg", "photos/photo9.jpeg",
      "photos/photo10.jpeg", "photos/photo11.png", "photos/photo12.jpeg", 
      "photos/photo13.jpeg", "photos/photo14.jpeg", "photos/photo15.jpeg", "photos/photo16.jpeg"
    ];

    // PRELOAD IMAGES: This is the key fix for GitHub stuttering
    const preloadedImages = [];
    images.forEach((src) => {
      const img = new Image();
      img.src = src;
      preloadedImages.push(img);
    });

    const imgEl = document.getElementById("slideshow");
    let imgIndex = 0;

    function changeImage() {
      // 1. Fade out
      imgEl.style.opacity = 0; 
      
      // 2. Wait for fade out to complete (1 second matches CSS transition)
      setTimeout(() => {
        imgIndex = (imgIndex + 1) % images.length;
        // Use the preloaded source
        imgEl.src = images[imgIndex]; 
        
        // 3. Fade back in
        imgEl.style.opacity = 1;
      }, 500); 
    }

    const imageInterval = setInterval(changeImage, 3000); // Increased time to allow for the 1s fade

    // Typing logic (same as before)
    const text = `My Dear Sundari,
I was thinking of writing something and realised that i don't often tell you this but you make my life better just by being in it.

The way you talk, nuvvu vese kullu joke lu ğŸ˜‚, all the things make me happy and laugh and I really wish to hear more of those.

Inka andam gurinchi matladite.....those eyes, those lips and that smile and that nadumu are more than enough to melt and make me forget all the noises and disturbances in my head and heart. The best look for me is you being lazy in a not so tight T-shirt with a messy bun wearing spects ğŸ« . You are and will be the most prettiest woman.

I am not perfect, you are not perfect and we together can have a very happy imperfect life with all the joys and sorrows added with a lots and lots of sarasalu ofcourse as soon as you accept my proposal ğŸ™ƒ, I don't regret my choice and if i had to do it all over again I will do it in a heartbeat without a thought. 
To more love and memories ahead ğŸ¥‚. Oppesukove ğŸ™‡ğŸ»â€â™‚ï¸.

Love you Bangaram ğŸ’›....`;

    const messageEl = document.getElementById("message");
    const valentineEl = document.getElementById("valentine");
    const finalEl = document.getElementById("final");
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");

    let index = 0;
    function typeWriter() {
      if (index < text.length) {
        messageEl.innerHTML += text.charAt(index);
        index++;
        const isAtBottom = messageEl.scrollHeight - messageEl.clientHeight <= messageEl.scrollTop + 50;
        if (isAtBottom) { messageEl.scrollTop = messageEl.scrollHeight; }
        setTimeout(typeWriter, 40); 
      } else {
        clearInterval(imageInterval); 
        setTimeout(() => { valentineEl.classList.remove("hidden"); }, 1000);
      }
    }
    typeWriter();

    // No button logic (same as before)
    noBtn.addEventListener("mouseover", () => {
      noBtn.style.position = "fixed";
      const x = Math.random() * (window.innerWidth - noBtn.offsetWidth - 50);
      const y = Math.random() * (window.innerHeight - noBtn.offsetHeight - 50);
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
    });

    yesBtn.addEventListener("click", () => {
      // Get the audio element and play it
      const audio = document.getElementById("loveSong");
      audio.play().catch(error => {
        console.log("Audio playback failed:", error);
      });
      valentineEl.classList.add("hidden");
      imgEl.style.display = "none"; 
      messageEl.classList.add("hidden");
      document.querySelectorAll('.corner-flower').forEach(f => f.style.display = 'none');
      finalEl.classList.remove("hidden");
    });
  </script>
</body>
</html>